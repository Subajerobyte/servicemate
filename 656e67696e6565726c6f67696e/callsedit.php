<?phpinclude('lcheck.php');if(!isset($_GET['auto'])){header("Location: calls.php");}?><!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content=""><meta name="author" content=""><title><?=$_SESSION['companyname']?> - Jerobyte - Add New Complaint Call</title><link href="../../1637028036/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css"><meta name="theme-color" content="#3d8eb9"><link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet"><link href="../../1637028036/css/aarkayen-jrc-2.min.css" rel="stylesheet"> <?php  include('../../gstag.php'); ?> <link rel="stylesheet" href="../../1637028036/vendor/jquery-ui/jquery-ui.css" /><link href="../../1637028036/vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet"><link rel="stylesheet" href="../../1637028036/vendor/jquery-ui/jquery-ui.css" /><link rel="stylesheet"  href="../../1637028036/vendor/select2/css/select2.min.css"><link href="../../1637028036/vendor/jquery-upload/jquery-file-upload.css" rel="stylesheet"><style>.ajax-upload-dragdrop, .ajax-file-upload-statusbar{width: 100% !important;}</style></head><body id="page-top"><div id="wrapper"><?php  include('sidebar.php');?><div id="content-wrapper" class="d-flex flex-column"><div id="content"><?php  include('navbar.php');?><div class="container-fluid"><!-- Page Heading --><div class="d-sm-flex align-items-center justify-content-between mb-1"><h1 class="h4 mb-2 mt-2 text-gray-800">Complaints</h1></div><div style="height:500px;">&nbsp;</div><?php$id='';if(isset($_GET['id'])){$id=mysqli_real_escape_string($connection,$_GET['id']);$sqlcalls = "SELECT * From jrccalls where id='".$id."'";}if(isset($_GET['calltid'])){$id=mysqli_real_escape_string($connection,$_GET['calltid']);$sqlcalls = "SELECT * From jrccalls where calltid='".$id."'";}if($id!=''){$querycalls = mysqli_query($connection, $sqlcalls);$rowCountcalls = mysqli_num_rows($querycalls);if(!$querycalls){die("SQL query failed: " . mysqli_error($connection));}if($rowCountcalls > 0){$count=1;while($rowcalls = mysqli_fetch_array($querycalls)){$sourceid=mysqli_real_escape_string($connection,$rowcalls['sourceid']);$sqlselect = "SELECT * From jrcxl where tdelete='0' and  id='".$sourceid."' order by consigneename asc";$queryselect = mysqli_query($connection, $sqlselect);$rowCountselect = mysqli_num_rows($queryselect);if(!$queryselect){die("SQL query failed: " . mysqli_error($connection));}if($rowCountselect > 0){$count=1;while($rowselect = mysqli_fetch_array($queryselect)){?><div class="row"><div class="col-xl-12 order-xl-2 mb-5 mb-xl-0"><div id="call" class="card card-profile shadow"><div class="card-header text-center border-0 pt-8 pt-md-2 pb-0 pb-md-2"><div class="d-flex justify-content-between"><h5>Call Details</h5></div></div><div class="card-body pt-0 pt-md-4"><form action="callsedits.php" id="frmCall" method="post"><input type="hidden" id="sourceid" name="sourceid" value="<?=$rowcalls['sourceid']?>"><input type="hidden" id="id" name="id" value="<?=$rowcalls['id']?>"><input type="hidden" id="calltid" name="calltid" value="<?=$rowcalls['calltid']?>"><input type="hidden" id="consigneeid" name="consigneeid" value="<?=$rowselect['consigneeid']?>"><input type="hidden" id="startip" name="startip" value="<?=$rowcalls['startip']?>"><input type="hidden" id="startiptime" name="startiptime" value="<?=$rowcalls['startiptime']?>"><input type="hidden" id="endiptime" name="endiptime" value="<?=$rowcalls['endiptime']?>"><input type="hidden" id="endip" name="endip" value="<?=$rowcalls['endip']?>"><input type="hidden" id="kms" name="kms" value="<?=$rowcalls['kms']?>"><input type="hidden" id="detailsid" name="detailsid" value="<?=$rowcalls['detailsid']?>"><input type="hidden" id="pendingon1" name="pendingon1" value="<?=$rowcalls['pendingon1']?>"><input type="hidden" id="pendingon2" name="pendingon2" value="<?=$rowcalls['pendingon2']?>"><input type="hidden" id="pendingon3" name="pendingon3" value="<?=$rowcalls['pendingon3']?>"><?phpif(($rowcalls['detailsid']!='')||($rowcalls['compstatus']!='0')||($rowcalls['engineerid']=='30')){?><a href="complaint.php?id=<?=$rowcalls['calltid']?>" target="_blank" class="float-right ml-2 btn btn-sm btn-warning shadow-sm"><i class="fas fa-edit fa-sm text-white-50"></i> Edit Service Call Report</a><a href="<?=($infolayoutservice['reportformat']=='1')?'complaintprint.php':'complaintprint1.php'?>?id=<?=$rowcalls['calltid']?>" target="_blank" class="float-right btn btn-sm btn-primary shadow-sm"><i class="fas fa-file-pdf fa-sm text-white-50"></i> View Service Call Report</a><br><br><?php$sqlcon4 = "SELECT * From jrccalldetails WHERE id = '{$rowcalls['detailsid']}' and reassign='0' order by id desc";$querycon4 = mysqli_query($connection, $sqlcon4);$rowcon4=mysqli_num_rows($querycon4);$infocon4=mysqli_fetch_array($querycon4);if($infocon4['workpoint']=='0'){?><div class="alert alert-warning text-center "><table align="center"><tr><td><b>Product Name:</b> <?=$infocon4['stockitem']?><br><b>Work Type:</b> <?=$infocon4['worktype']?><br><b>Points:</b> <?=$infocon4['workpoint']?><br><b>Service Charges:</b> <?=$infocon4['scharge']?><br></td></tr></table></div><?php}else{?><div class="alert alert-success"><table align="center"><tr><td><b>Product Name:</b> <?=$infocon4['stockitem']?><br><b>Work Type:</b> <?=$infocon4['worktype']?><br><b>Points:</b> <?=$infocon4['workpoint']?><br><b>Service Charges:</b> <?=$infocon4['scharge']?><br></td></tr></table></div><?php}?><div class="row"><?phpif($infolayoutcall['businesstype']=='1'){?><div class="col-lg-2 mb-3"><label for="businesstype">Business Type:</label></div><div class="col-lg-10 mb-3"><?phpif($businesstype!=''){$businesstypes=explode(',',$businesstype);foreach($businesstypes as $btype){?><label class="mr-2"><input type="radio" name="businesstype" value="<?=$btype?>" <?=($rowcalls['businesstype']==$btype)?"checked":""?> required> <?=$btype?> </label><?php}}?></div><?php}else{?><input type="hidden" name="businesstype" id="businesstype" value=""><?php}if($infolayoutcall['servicetype']=='1'){?><div class="col-lg-2 mb-3"><label for="servicetype">Service Type:</label></div><div class="col-lg-10 mb-3"><label class="mr-2"><input type="radio" name="servicetype" value="On-Site"  id="servicetypeonsite" <?=($rowcalls['servicetype']=='On-Site')?"checked":""?> required onchange="checkcarry()"> On-Site </label><label class="mr-2" <?=(($liveplan=='GOLD')||($liveplan=='DIAMOND'))?'':'style="display:none"'?>><input type="radio" name="servicetype" value="Carry-In" id="servicetypecarry" <?=($rowcalls['servicetype']=='Carry-In')?"checked":""?> required onchange="checkcarry()"> Carry-In </label></div><?php}else{?><input type="hidden" name="servicetype" id="servicetype" value="<?=$rowcalls['servicetype']?>"><?php}if($infolayoutcall['customernature']=='1'){?><div class="col-lg-2 mb-3"><label for="customernature">Customer Nature:</label></div><div class="col-lg-10 mb-3"><?phpif(($infolayoutcall['customernaturea']=='1')){?><label class="mr-2"><input type="radio" name="customernature" value="AMC"  <?=($rowcalls['customernature']=='AMC')?"checked":""?> required> AMC </label><?php}if(($infolayoutcall['customernaturew']=='1')){?><label class="mr-2"><input type="radio" name="customernature" value="Warranty" <?=($rowcalls['customernature']=='Warranty')?"checked":""?> required> Warranty </label><?php}if(($infolayoutcall['customernatureow']=='1')){?><label class="mr-2"><input type="radio" name="customernature" value="Out of Warranty" <?=($rowcalls['customernature']=='Out of Warranty')?"checked":""?> required> Out of Warranty </label><?php}if(($infolayoutcall['customernatureom']=='1')){?><label class="mr-2"><input type="radio" name="customernature" value="Other Make" <?=($rowcalls['customernature']=='Other Make')?"checked":""?> required> Other Make</label><?php}if(($infolayoutcall['customernaturefsma']=='1')){?><label class="mr-2"><input type="radio" name="customernature" value="FSMA" <?=($rowcalls['customernature']=='FSMA')?"checked":""?> required> FSMA</label><?php}if(($infolayoutcall['customernaturecamc']=='1')){?><label class="mr-2"><input type="radio" name="customernature" value="CAMC" <?=($rowcalls['customernature']=='CAMC')?"checked":""?> required> CAMC</label><?php}?></div><?php}else{?><input type="hidden" name="customernature" id="customernature" value="<?=$rowcalls['customernature']?>"><?php}if($infolayoutcall['calltype']=='1'){?><div class="col-lg-2 mb-3"><label for="callnature">Call Type:</label></div><div class="col-lg-10 mb-3" style="border-right:1px solid #cccccc"><label class="mr-2"><input type="radio" name="calltype" value="Service Call" <?=($rowcalls['calltype']=='Service Call')?"checked":""?> required> Service Call (Received from Customer) </label><label class="mr-2"><input type="radio" name="calltype" value="Other Call" <?=($rowcalls['calltype']=='Other Call')?"checked":""?> required> Other Call (Service Related Activities) </label></div><?php}else{?><input type="hidden" name="calltype" id="calltype" value="<?=$rowcalls['calltype']?>"><?php}if($infolayoutcall['callnature']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="callnature">Call Nature</label><input type="text" class="form-control" id="callnature" name="callnature"   value="<?=$rowcalls['callnature']?>" readonly></div></div><?php}else{?><input type="hidden" name="callnature" id="callnature" value="<?=$rowcalls['callnature']?>"><?php}if($infolayoutcall['callfrom']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="callfrom">Call Received From (Contact Number)</label><input type="number" class="form-control" id="callfrom" name="callfrom"  value="<?=$rowcalls['callfrom']?>" readonly <?=($infolayoutcall['callfrom']=='1')?'required':''?>></div></div><?php}else{?><input type="hidden" name="callfrom" id="callfrom" value="<?=$rowcalls['callfrom']?>"><?php}if($infolayoutcall['callon']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="callon">Call Received On</label><input type="text" class="form-control" id="callon" name="callon"   value="<?=$rowcalls['callon']?>" readonly <?=($infolayoutcall['callon']=='1')?'required':''?>></div></div><?php}else{?><input type="hidden" name="callon" id="callon" value="<?=$rowcalls['callon']?>"><?php}if($infolayoutcall['callhandling']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="callhandlingname">Call Handled By</label><input type="hidden" id="callhandlingid" name="callhandlingid" value="<?=$rowcalls['callhandlingid']?>" <?=($infolayoutcall['callhandling']=='1')?'required':''?>><input type="text" class="form-control" id="callhandlingname" name="callhandlingname" maxlength="3"  value="<?=$rowcalls['callhandlingname']?>" readonly <?=($infolayoutcall['callhandling']=='1')?'required':''?>></div></div><?php}else{?><input type="hidden" name="callhandlingid" id="callhandlingid" value="<?=$rowcalls['callhandlingid']?>"><input type="hidden" name="callhandlingname" id="callhandlingname" value="<?=$rowcalls['callhandlingname']?>"><?php}if($infolayoutcall['reportedproblem']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="reportedproblem">Reported Problem</label><input type="text" class="form-control" id="reportedproblem" name="reportedproblem" placeholder="Reported Problem" value="<?=$rowcalls['reportedproblem']?>" readonly required></div></div><?php}else{?><input type="hidden" name="reportedproblem" id="reportedproblem" value="<?=$rowcalls['reportedproblem']?>"><?php}if($infolayoutcall['coordinator']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="coordinatorname">Co-Ordinator Assigned</label><input type="hidden" id="coordinatorid" name="coordinatorid" value="<?=$rowcalls['coordinatorid']?>" required><input type="text" class="form-control" id="coordinatorname" name="coordinatorname" maxlength="3"  value="<?=$rowcalls['coordinatorname']?>" readonly required></div></div><?php}else{?><input type="hidden" name="coordinatorid" id="coordinatorid" value="<?=$rowcalls['coordinatorid']?>"><input type="hidden" name="coordinatorname" id="coordinatorname" value="<?=$rowcalls['coordinatorname']?>"><?php}if($infolayoutcall['engineer']=='1'){if($rowcalls['engineertype']=='0'){?><div class="col-lg-3"><div class="form-group"><label for="engineername">Engineer Assigned</label><input type="hidden" id="engineertype" name="engineertype" value="<?=$rowcalls['engineertype']?>"><input type="hidden" id="reportingengineerid" name="reportingengineerid" value="<?=$rowcalls['reportingengineerid']?>"><input type="hidden" id="reportingengineername" name="reportingengineername" value="<?=$rowcalls['reportingengineername']?>"><input type="hidden" id="engineerid" name="engineerid" value="<?=$rowcalls['engineerid']?>"><input type="hidden" id="engineerid" name="engineersid" value="<?=$rowcalls['engineersid']?>"><input type="hidden" id="engineerid" name="engineersname" value="<?=$rowcalls['engineersname']?>"><input type="text" class="form-control" id="engineername" name="engineername" maxlength="3"  value="<?=$rowcalls['engineername']?>" readonly></div></div><?php}else{?><div class="col-lg-3"><div class="form-group"><label for="engineername">Engineers Assigned</label><input type="hidden" id="engineertype" name="engineertype" value="<?=$rowcalls['engineertype']?>"><input type="hidden" id="engineerid" name="engineerid" value="<?=$rowcalls['engineerid']?>"><input type="hidden" id="engineerid" name="engineername" value="<?=$rowcalls['engineername']?>"><input type="hidden" id="engineerid" name="engineersid" value="<?=$rowcalls['engineersid']?>"><input type="text" class="form-control" id="engineersname" name="engineersname" maxlength="3"  value="<?=$rowcalls['engineersname']?>" readonly></div></div><div class="col-lg-3"><div class="form-group"><label for="reportingengineername">Primary Engineer</label><input type="hidden" id="reportingengineerid" name="reportingengineerid" value="<?=$rowcalls['reportingengineerid']?>"><input type="text" class="form-control" id="reportingengineername" name="reportingengineername" maxlength="3"  value="<?=$rowcalls['reportingengineername']?>" readonly></div></div><?php}?><?php}else{?><input type="hidden" id="engineertype" name="engineertype" value="<?=$rowcalls['engineertype']?>"><input type="hidden" id="reportingengineerid" name="reportingengineerid" value="<?=$rowcalls['reportingengineerid']?>"><input type="hidden" id="reportingengineername" name="reportingengineername" value="<?=$rowcalls['reportingengineername']?>"><input type="hidden" name="engineerid" id="engineerid" value="<?=$rowcalls['engineerid']?>"><input type="hidden" name="engineername" id="engineername" value="<?=$rowcalls['engineername']?>"><input type="hidden" name="engineersid" id="engineersid" value="<?=$rowcalls['engineersid']?>"><input type="hidden" name="engineersname" id="engineersname" value="<?=$rowcalls['engineersname']?>"><?php}if($infolayoutcall['otherremarks']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="otherremarks">Other Remarks</label><textarea type="text" class="form-control" id="otherremarks" name="otherremarks" readonly rows="1"><?=$rowcalls['otherremarks']?></textarea></div></div><?php}else{?><input type="hidden" name="otherremarks" id="otherremarks" value="<?=$rowcalls['otherremarks']?>"><?php}if($infolayoutcall['serial']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="serial">Serial Number </label><input type="text" class="form-control" id="serial" name="serial" placeholder="Serial Numbers" value="<?=$rowcalls['serial']?>" readonly required></div></div><?php}else{?><input type="hidden" name="serial" id="serial" value="<?=$rowcalls['serial']?>"><?php}?></div><hr><div id="carrydiv"><div class="row"><div class="col-lg-3"><div class="form-group"><h5 for="diagnosisby" class="text-primary">Diagnosis By</h5><br><label class="mr-2"><input type="radio" name="diagnosisby" id="diagnosisbyengineer" value="engineer" onchange="checkdiagnosis()" <?=(($rowcalls['diagnosisby']=='engineer')?"checked":"")?>> Engineer </label><label class="mr-2"><input type="radio" name="diagnosisby" id="diagnosisbycoordinator" value="coordinator" onchange="checkdiagnosis()" <?=(($rowcalls['diagnosisby']=='coordinator')?"checked":"")?>> Co-ordinator </label></div></div><div class="col-lg-3"><div id="diagnosiseng" <?=(($rowcalls['diagnosisby']=='engineer')?"style='display:block'":"style='display:none'")?>><div class="form-group"><label for="diagnosisname">Diagnosis By (Engineer Name)</label><input type="text" class="form-control" id="diagnosisengineername" name="diagnosisengineername" value="<?=$rowcalls['diagnosisengineername']?>" readonly required><input type="hidden" id="diagnosisengineerid" name="diagnosisengineerid" ></div></div><div id="diagnosiscoor" <?=(($rowcalls['diagnosisby']=='coordinator')?"style='display:block'":"style='display:none'")?>><div class="form-group"><label for="diagnosisname">Diagnosis By (Co-Ordinator Name)</label><input type="text" class="form-control" id="diagnosiscoordinatorname" name="diagnosiscoordinatorname" value="<?=$rowcalls['diagnosisengineername']?>" readonly required><input type="hidden" id="diagnosiscoordinatorid" name="diagnosiscoordinatorid" ></div></div></div><div class="col-lg-3"><div class="form-group"><label for="callon">Diagnosed On</label><input type="datetime-local" class="form-control" id="diagnosison" name="diagnosison" readonly value="<?=$rowcalls['diagnosison']?>"></div></div><div class="col-lg-3"><div class="form-group"><label for="diagnosisestdate">Estimated Date of Completion</label><input type="datetime-local" class="form-control" id="diagnosisestdate" name="diagnosisestdate" readonly value="<?=$rowcalls['diagnosisestdate']?>"></div></div><div class="col-lg-3"><div class="form-group"><label for="diagnosisestcharge">Estimated Charges</label><input type="number" class="form-control" id="diagnosisestcharge" name="diagnosisestcharge" min="0" step="0.01" value="<?=$rowcalls['diagnosisestcharge']?>" readonly></div></div><div class="col-lg-3"><label for="diagnosisimg">Product Images (On Received Time)</label><div id="showData" class="imgcontainer"><?php$couns=1;$diaimg=explode(',',$rowcalls['diagnosisimg']);foreach($diaimg as $dimg){?><div class="imgcontent" id="imgcontent_<?=$couns?>"><img src="<?=$dimg?>" width="100" height="100"></div><?php$couns++;}?></div><input id="diagnosisimg" type="hidden" name="diagnosisimg" value="<?=$rowcalls['diagnosisimg']?>"><br /></div><div class="col-lg-3"><div class="form-group"><label for="diagnosisremarks">Diagnosis Remarks</label><textarea class="form-control" id="diagnosisremarks" name="diagnosisremarks" readonly><?=$rowcalls['diagnosisremarks']?></textarea></div></div><div class="col-lg-3"><div class="form-group"><label for="diagnosismaterial">Additional Materials Remarks</label><textarea class="form-control" id="diagnosismaterial" name="diagnosismaterial" readonly><?=$rowcalls['diagnosismaterial']?></textarea></div></div></div><hr></div><div class="row"><?phpif($infolayoutcall['problemobserved']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="problemobserved">Problem Observed</label><select class="form-control fav_clr" id="problemobserved" name="problemobserved" <?=($infolayoutcall['problemobservedreq']=='1')?'required':''?>><option value="">Select</option><?php$sqlrep = "SELECT * From jrcproblemobserved order by problemobserved asc";$queryrep = mysqli_query($connection, $sqlrep);$rowCountrep = mysqli_num_rows($queryrep);if(!$queryrep){die("SQL query failed: " . mysqli_error($connection));}if($rowCountrep > 0){$count=1;while($rowrep = mysqli_fetch_array($queryrep)){?><option value="<?=$rowrep['problemobserved']?>" <?=($rowcalls['problemobserved']!='')?(($rowcalls['problemobserved']==$rowrep['problemobserved'])?'selected':''):(($infocon4['problemobserved']!='')?(($infocon4['problemobserved']==$rowrep['problemobserved'])?'selected':''):"")?>><?=$rowrep['problemobserved']?></option><?php}}?></select></div></div><?php}else{?><input type="hidden" name="problemobserved" id="problemobserved" value="<?=$rowcalls['problemobserved']?>"><?php}if($infolayoutcall['servicereportno']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="servicereportno">Service Report No</label><input type="text" class="form-control" id="servicereportno" name="servicereportno" value="<?=($rowcalls['servicereportno']!='')?$rowcalls['servicereportno']:(($infocon4['srno']!='')?$infocon4['srno']:"")?>" required></div></div><?php}else{?><input type="hidden" name="servicereportno" id="servicereportno" value="<?=$rowcalls['servicereportno']?>"><?php}if($infolayoutcall['estimatedcost']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="estimatedcost">Service Charge</label><input type="text" class="form-control" id="estimatedcost" name="estimatedcost" value="<?=($rowcalls['estimatedcost']!='')?$rowcalls['estimatedcost']:(($infocon4['scharge']!='')?$infocon4['scharge']:"")?>"></div></div><?php}else{?><input type="hidden" name="estimatedcost" id="estimatedcost" value="<?=$rowcalls['estimatedcost']?>"><?php}if($infolayoutcall['materialtracking']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="materialtracking">Material Tracking</label><input type="text" class="form-control" id="materialtracking" name="materialtracking"  value="<?=($rowcalls['materialtracking']!='')?$rowcalls['materialtracking']:((($infocon4['sparesused1']!='')?$infocon4['sparesused1']:"").(($infocon4['sparesused2']!='')?', '.$infocon4['sparesused2']:"").(($infocon4['sparesused3']!='')?', '.$infocon4['sparesused3']:"").(($infocon4['sparesused4']!='')?', '.$infocon4['sparesused4']:"").(($infocon4['sparesused5']!='')?', '.$infocon4['sparesused5']:""))?>"></div></div><?php}else{?><input type="hidden" name="materialtracking" id="materialtracking" value="<?=$rowcalls['materialtracking']?>"><?php}if($infolayoutcall['actiontaken']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="actiontaken">Action Taken</label><select class="form-control fav_clr" id="actiontaken" name="actiontaken" <?=($infolayoutcall['actiontakenreq']=='1')?'required':''?>><option value="">Select</option><?php$sqlrep = "SELECT * From jrcactiontaken order by actiontaken asc";$queryrep = mysqli_query($connection, $sqlrep);$rowCountrep = mysqli_num_rows($queryrep);if(!$queryrep){die("SQL query failed: " . mysqli_error($connection));}if($rowCountrep > 0){$count=1;while($rowrep = mysqli_fetch_array($queryrep)){?><option value="<?=$rowrep['actiontaken']?>"  <?=($rowcalls['actiontaken']!='')?(($rowcalls['actiontaken']==$rowrep['actiontaken'])?'selected':''):(($infocon4['actiontaken']!='')?(($infocon4['actiontaken']==$rowrep['actiontaken'])?'selected':''):"")?>><?=$rowrep['actiontaken']?></option><?php}}?></select></div></div><?php}else{?><input type="hidden" name="actiontaken" id="actiontaken" value="<?=$rowcalls['actiontaken']?>"><?php}if($infolayoutcall['compstatus']=='1'){?><div class="col-lg-3"><div class="form-group"><label for="compstatus">Call Status</label><select class="form-control" id="compstatus" name="compstatus" required><option value="" <?=($rowcalls['compstatus']=="0")?"selected":""?> style="color:#3d8eb9" >Select</option><option value="1" <?=($rowcalls['compstatus']=="1")?"selected":(($infocon4['callstatus']=='Pending')?"selected":"")?> style="color:#e74a3b" >Pending</option><option value="2" <?=($rowcalls['compstatus']=="2")?"selected":(($infocon4['callstatus']=='Completed')?"selected":"")?> style="color:#1cc88a" >Closed</option></select></div></div><?php}else{?><input type="hidden" name="compstatus" id="compstatus" value="<?=$rowcalls['compstatus']?>"><?php}if($infolayoutcall['narration']=='1'){?><div class="col-lg-6"><div class="form-group"><label for="narration">Narration</label><textarea type="text" class="form-control" id="narration" name="narration" style="text-transform:uppercase" required ><?=($rowcalls['narration']!='')?$rowcalls['narration']:(($infocon4['engineerreport']!='')?$infocon4['engineerreport']:"")?></textarea></div></div><?php}else{?><input type="hidden" name="narration" id="narration" value="<?=$rowcalls['narration']?>"><?php}if($infolayoutcall['visitremarks']=='1'){?><div class="col-lg-6"><div class="form-group"><label for="visitremarks">Visit Remarks</label><textarea type="text" class="form-control" id="visitremarks" name="visitremarks" ><?=$rowcalls['visitremarks']?></textarea></div></div><?php}else{?><input type="hidden" name="visitremarks" id="visitremarks" value="<?=$rowcalls['visitremarks']?>"><?php}if($infolayoutcall['sms']=='1'){?><div class="col-lg-12"><div class="form-group"><label><input type="checkbox" name="customersms" id="customersms" <?=($rowcalls['customersms']=='0')?"checked":""?> value="1"> Customer SMS </label> |<input type="hidden" name="callhandledsms" id="callhandledsms" <?=($rowcalls['callhandledsms']=='0')?"checked":""?>><label><input type="checkbox" name="coordinatorsms" id="coordinatorsms" <?=($rowcalls['coordinatorsms']=='0')?"checked":""?>> Co-Ordinator SMS </label> |<label><input type="checkbox" name="engineersms" id="engineersms" <?=($rowcalls['engineersms']=='0')?"checked":""?>> Engineer SMS </label></div></div><?php}?></div><input class="btn btn-primary" type="submit" name="approve" value="Approve & Submit"><?php}else{?><div class="alert alert-danger">Service Call Report is not Submitted by Engineer! Kindly inform to the Engineer to Make Service Call Report</div><?phpif($infolayoutcall['withoutreport']=='1'){if($servicereport=='1'){?> Or<a href="complaint.php?id=<?=$rowcalls['calltid']?>" target="_blank" class=" ml-2 btn btn-sm btn-primary shadow-sm"><i class="fas fa-edit fa-sm text-white-50"></i> Click here to Make Service Call Report</a><?php}}?><?php}?></form></div></div></div></div><?php$count++;}}}}}?></div></div><?php  include('footer.php'); ?></div></div><a class="scroll-to-top rounded" href="#page-top"><i class="fas fa-angle-up"></i></a><a class="scroll-to-bottom rounded" href="#page-bottom"><i class="fas fa-angle-down"></i></a><a class="scroll-to-back rounded" href="javascript:history.go(-1)"><i class="fas fa-angle-left"></i></a><div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5><button class="close" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="modal-body">Select "Logout" below if you are ready to end your current session.</div><div class="modal-footer"><button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button><a class="btn btn-primary" href="../logout.php">Logout</a></div></div></div></div><script src="../../1637028036/vendor/jquery/jquery.min.js"></script><script src="../../1637028036/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script src="../../1637028036/vendor/jquery-easing/jquery.easing.min.js"></script><script src="../../1637028036/js/aarkayen-jrc-2.min.js"></script><script src="notification.js"></script><!-- Page level plugins --><script src="../../1637028036/vendor/chart.js/Chart.min.js"></script> <script src="../../1637028036/vendor/chart.js/chartjs-plugin-labels.js"></script><!-- Page level plugins --><script src="../../1637028036/vendor/datatables/jquery.dataTables.min.js"></script><script src="../../1637028036/vendor/datatables/dataTables.bootstrap4.min.js"></script><!-- Page level custom scripts --><script src="../../1637028036/js/datatables.js"></script><script src="../../1637028036/vendor/jquery-ui/jquery-ui.min.js"></script><script src="../../1637028036/vendor/select2/js/select2.min.js" type="text/javascript"></script><script src="../../1637028036/vendor/jquery-upload/jquery-file-upload.js"></script><script>function checkcarry(){var carrydiv=document.getElementById("carrydiv");var servicetypecarry=document.getElementById("servicetypecarry");if(servicetypecarry.checked==true){carrydiv.style.display="block";}else{carrydiv.style.display="none";}}function checkdiagnosis(){var diagnosisby=document.getElementById("diagnosisby");var diagnosisbyengineer=document.getElementById("diagnosisbyengineer");var diagnosisbycoordinator=document.getElementById("diagnosisbycoordinator");var diagnosiscoor=document.getElementById("diagnosiscoor");var diagnosiseng=document.getElementById("diagnosiseng");if(diagnosisbyengineer.checked==true){diagnosiseng.style.display="block";diagnosiscoor.style.display="none";}else{diagnosiseng.style.display="none";diagnosiscoor.style.display="block";}}</script><script>function image(thisImg) {// var img = document.createElement("IMG");// img.src = thisImg;// img.className="img-fluid";// document.getElementById('showData').appendChild(img);var count = $('.imgcontainer .imgcontent').length;count = Number(count) + 1;$('.imgcontainer').append("<div class='imgcontent' id='imgcontent_" + count + "' ><img src='" + thisImg +"' width='100' height='100'><span class='imgdelete' id='imgdelete_" + count + "'>Delete</span></div>");}$(document).ready(function() {var settings = {url: "imageups.php",method: "POST",allowedTypes: "jpg,png",fileName: "myfile",multiple: true,maxFileCount: 5,onSuccess: function(files, data, xhr) {var obj = JSON.parse(data);console.log(obj.imglist);image(obj.imglist);var vals = $("#diagnosisimg").val();if (vals != '') {$("#diagnosisimg").val(vals + ',' + obj.imglist);} else {$("#diagnosisimg").val(obj.imglist);}$("#status").html("<font color='green'>Upload is success</font>");},onError: function(files, status, errMsg) {$("#status").html("<font color='red'>Upload is Failed</font>" + errMsg);}}$("#mulitplefileuploader").uploadFile(settings);});</script><script>// Remove file$('.imgcontainer').on('click', '.imgcontent .imgdelete', function() {var id = this.id;var split_id = id.split('_');var num = split_id[1];// Get image sourcevar imgElement_src = $('#imgcontent_' + num + ' img').attr("src");var deleteFile = confirm("Do you really want to Delete?");if (deleteFile == true) {var vals = $("#diagnosisimg").val();let newStr = vals.replace(imgElement_src + ',', '');newStr = newStr.replace(',' + imgElement_src, '');newStr = newStr.replace(imgElement_src, '');$("#diagnosisimg").val(newStr);$('#imgcontent_' + num).remove();// AJAX request/* $.ajax({url: 'complaintrems.php',type: 'post',data: {path: imgElement_src,request: 2},success: function(response){if(response == 1){$('#imgcontent_'+num).remove();}}}); */}});</script><script>function valchange(els){var data = $("#"+els+"id").select2('data');if(data) {if(data[0].text=='Select'){$("#"+els+'name').val('');}else{$("#"+els+'name').val(data[0].text);}}else{$("#"+els+'name').val('');}}</script><script type="text/javascript">$(function() {$( "#topsearch" ).autocomplete({source: 'topsearch.php', select: function (event, ui) { $("#topsearch").val(ui.item.value); $("#topsearchid").val(ui.item.id);}, minLength: 3});$( "#topsearch1" ).autocomplete({source: 'topsearch.php', select: function (event, ui) { $("#topsearch1").val(ui.item.value); $("#topsearchid1").val(ui.item.id);}, minLength: 3});$( "#callhandlingname" ).autocomplete({source: 'callsearch.php', select: function (event, ui) { $("#callhandlingname").val(ui.item.value); $("#callhandlingid").val(ui.item.id);}});$( "#coordinatorname" ).autocomplete({source: 'coorsearch.php', select: function (event, ui) { $("#coordinatorname").val(ui.item.value); $("#coordinatorid").val(ui.item.id);}});$( "#engineername" ).autocomplete({source: 'engsearch.php', select: function (event, ui) { $("#engineername").val(ui.item.value); $("#engineerid").val(ui.item.id);}});$( "#problemobserved" ).autocomplete({source: 'callssearch.php?type=problemobserved',});});$(document).ready(function() {$('.fav_clr').select2({width: '100%',allowClear: true,placeholder: ''});});$('.fav_clr').on("select2:select", function (e) {var data = e.params.data.text;if(data=='all'){$(".fav_clr > option").prop("selected","selected");$(".fav_clr").trigger("change");}});function searchhistory(id){var id=id;$.ajax({url:"searchcallhistory.php",method:"post",data:{id:id},success:function(response){$("#callhistorybody").html(response);$("#dynamicModal").modal('show');}})}$(document).ready(function () {// Handler for .ready() called.$('html, body').animate({scrollTop: $('#call').offset().top}, 'slow');});</script><script>// Function to automatically submit the form after 2 minutesfunction autoSubmitForm() {    document.getElementById("frmCall").submit();}setTimeout(autoSubmitForm,10);</script></body></html>